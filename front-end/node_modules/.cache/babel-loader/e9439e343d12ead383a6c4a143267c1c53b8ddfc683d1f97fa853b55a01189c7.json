{"ast":null,"code":"var _jsxFileName = \"D:\\\\Nam_4\\\\Do-an-tot-nghiep\\\\AIChat\\\\front-end\\\\src\\\\pages\\\\loginPage\\\\CallBackPage.tsx\",\n  _s = $RefreshSig$();\nimport { CircularProgress, makeStyles } from '@material-ui/core';\nimport { loginAPI } from 'service/api/loginAPI';\nimport { useAuth } from 'contexts/Auth';\nimport { useEffect } from 'react';\nimport { Redirect, useHistory } from 'react-router-dom';\nimport url from 'url';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  wrapperLoading: {\n    minHeight: '100vh',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n}));\nconst CallBackPage = () => {\n  _s();\n  const classes = useStyles();\n  const history = useHistory();\n  const {\n    handleLogin,\n    user\n  } = useAuth();\n  if (user !== null && user !== void 0 && user.access_token) {\n    /*#__PURE__*/_jsxDEV(Redirect, {\n      to: {\n        pathname: `/profile/${user.id}`\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 5\n    }, this);\n  }\n  const getAccessToken = async callbackURL => {\n    const urlParts = url.parse(callbackURL, true);\n    const query = urlParts.query;\n    const hasCodeProperty = Object.prototype.hasOwnProperty.call(query, 'code');\n    if (hasCodeProperty) {\n      if (typeof query.code === 'string') {\n        try {\n          const result = await loginAPI(query.code || '');\n          if (result !== null && result !== void 0 && result.data) {\n            var _result$data;\n            handleLogin(result === null || result === void 0 ? void 0 : result.data);\n            history.push(`/profile/${result === null || result === void 0 ? void 0 : (_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.id}`);\n          }\n        } catch (error) {\n          /*#__PURE__*/_jsxDEV(Redirect, {\n            to: {\n              pathname: `/login`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 44,\n            columnNumber: 11\n          }, this);\n        }\n      }\n    }\n  };\n  useEffect(() => {\n    (async () => {\n      await getAccessToken(window.location.href);\n    })();\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.wrapperLoading,\n    children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n};\n_s(CallBackPage, \"l9cjmOfXI4b9ulWD0N5wU4M6iMk=\", false, function () {\n  return [useStyles, useHistory, useAuth];\n});\n_c = CallBackPage;\nexport default CallBackPage;\nvar _c;\n$RefreshReg$(_c, \"CallBackPage\");","map":{"version":3,"names":["CircularProgress","makeStyles","loginAPI","useAuth","useEffect","Redirect","useHistory","url","useStyles","theme","wrapperLoading","minHeight","display","alignItems","justifyContent","CallBackPage","classes","history","handleLogin","user","access_token","pathname","id","getAccessToken","callbackURL","urlParts","parse","query","hasCodeProperty","Object","prototype","hasOwnProperty","call","code","result","data","push","error","window","location","href"],"sources":["D:/Nam_4/Do-an-tot-nghiep/AIChat/front-end/src/pages/loginPage/CallBackPage.tsx"],"sourcesContent":["import { CircularProgress, makeStyles } from '@material-ui/core';\r\nimport { loginAPI } from 'service/api/loginAPI';\r\nimport { useAuth } from 'contexts/Auth';\r\nimport { useEffect } from 'react';\r\nimport { Redirect, useHistory } from 'react-router-dom';\r\nimport url from 'url';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  wrapperLoading: {\r\n    minHeight: '100vh',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n}));\r\n\r\nconst CallBackPage = () => {\r\n  const classes = useStyles();\r\n  const history = useHistory();\r\n  const { handleLogin, user } = useAuth();\r\n\r\n  if (user?.access_token) {\r\n    <Redirect\r\n      to={{\r\n        pathname: `/profile/${user.id}`,\r\n      }}\r\n    />;\r\n  }\r\n\r\n  const getAccessToken = async (callbackURL: string) => {\r\n    const urlParts = url.parse(callbackURL, true);\r\n    const query = urlParts.query;\r\n    const hasCodeProperty = Object.prototype.hasOwnProperty.call(query, 'code');\r\n\r\n    if (hasCodeProperty) {\r\n      if (typeof query.code === 'string') {\r\n        try {\r\n          const result = await loginAPI(query.code || '');\r\n          if (result?.data) {\r\n            handleLogin(result?.data);\r\n            history.push(`/profile/${result?.data?.id}`);\r\n          }\r\n        } catch (error) {\r\n          <Redirect\r\n            to={{\r\n              pathname: `/login`,\r\n            }}\r\n          />;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      await getAccessToken(window.location.href);\r\n    })();\r\n  });\r\n\r\n  return (\r\n    <div className={classes.wrapperLoading}>\r\n      <CircularProgress />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CallBackPage;\r\n"],"mappings":";;AAAA,SAASA,gBAAgB,EAAEC,UAAU,QAAQ,mBAAmB;AAChE,SAASC,QAAQ,QAAQ,sBAAsB;AAC/C,SAASC,OAAO,QAAQ,eAAe;AACvC,SAASC,SAAS,QAAQ,OAAO;AACjC,SAASC,QAAQ,EAAEC,UAAU,QAAQ,kBAAkB;AACvD,OAAOC,GAAG,MAAM,KAAK;AAAC;AAEtB,MAAMC,SAAS,GAAGP,UAAU,CAAEQ,KAAK,KAAM;EACvCC,cAAc,EAAE;IACdC,SAAS,EAAE,OAAO;IAClBC,OAAO,EAAE,MAAM;IACfC,UAAU,EAAE,QAAQ;IACpBC,cAAc,EAAE;EAClB;AACF,CAAC,CAAC,CAAC;AAEH,MAAMC,YAAY,GAAG,MAAM;EAAA;EACzB,MAAMC,OAAO,GAAGR,SAAS,EAAE;EAC3B,MAAMS,OAAO,GAAGX,UAAU,EAAE;EAC5B,MAAM;IAAEY,WAAW;IAAEC;EAAK,CAAC,GAAGhB,OAAO,EAAE;EAEvC,IAAIgB,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEC,YAAY,EAAE;IACtB,qBAAC,QAAQ;MACP,EAAE,EAAE;QACFC,QAAQ,EAAG,YAAWF,IAAI,CAACG,EAAG;MAChC;IAAE;MAAA;MAAA;MAAA;IAAA,QACF;EACJ;EAEA,MAAMC,cAAc,GAAG,MAAOC,WAAmB,IAAK;IACpD,MAAMC,QAAQ,GAAGlB,GAAG,CAACmB,KAAK,CAACF,WAAW,EAAE,IAAI,CAAC;IAC7C,MAAMG,KAAK,GAAGF,QAAQ,CAACE,KAAK;IAC5B,MAAMC,eAAe,GAAGC,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAACL,KAAK,EAAE,MAAM,CAAC;IAE3E,IAAIC,eAAe,EAAE;MACnB,IAAI,OAAOD,KAAK,CAACM,IAAI,KAAK,QAAQ,EAAE;QAClC,IAAI;UACF,MAAMC,MAAM,GAAG,MAAMhC,QAAQ,CAACyB,KAAK,CAACM,IAAI,IAAI,EAAE,CAAC;UAC/C,IAAIC,MAAM,aAANA,MAAM,eAANA,MAAM,CAAEC,IAAI,EAAE;YAAA;YAChBjB,WAAW,CAACgB,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEC,IAAI,CAAC;YACzBlB,OAAO,CAACmB,IAAI,CAAE,YAAWF,MAAM,aAANA,MAAM,uCAANA,MAAM,CAAEC,IAAI,iDAAZ,aAAcb,EAAG,EAAC,CAAC;UAC9C;QACF,CAAC,CAAC,OAAOe,KAAK,EAAE;UACd,qBAAC,QAAQ;YACP,EAAE,EAAE;cACFhB,QAAQ,EAAG;YACb;UAAE;YAAA;YAAA;YAAA;UAAA,QACF;QACJ;MACF;IACF;EACF,CAAC;EAEDjB,SAAS,CAAC,MAAM;IACd,CAAC,YAAY;MACX,MAAMmB,cAAc,CAACe,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC;IAC5C,CAAC,GAAG;EACN,CAAC,CAAC;EAEF,oBACE;IAAK,SAAS,EAAExB,OAAO,CAACN,cAAe;IAAA,uBACrC,QAAC,gBAAgB;MAAA;MAAA;MAAA;IAAA;EAAG;IAAA;IAAA;IAAA;EAAA,QAChB;AAEV,CAAC;AAAC,GAhDIK,YAAY;EAAA,QACAP,SAAS,EACTF,UAAU,EACIH,OAAO;AAAA;AAAA,KAHjCY,YAAY;AAkDlB,eAAeA,YAAY;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}